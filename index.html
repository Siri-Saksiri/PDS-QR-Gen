<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>QR Code Generator</title>
  <style>
    body {
      font-family: "Segoe UI", Arial, sans-serif;
      background: radial-gradient(circle at top, #1a1a1a, #0d0d0d);
      color: #fff;
      display: flex;
      flex-direction: column;
      justify-content: center;
      align-items: center;
      min-height: 100vh;
      margin: 0;
    }

    .container {
      background: #1e1e1e;
      padding: 24px 30px;
      border-radius: 20px;
      width: 400px;
      box-shadow: 0 0 25px rgba(60, 150, 255, 0.15);
      transition: transform 0.2s ease, box-shadow 0.3s ease;
    }

    .container:hover {
      transform: translateY(-4px);
      box-shadow: 0 0 35px rgba(60, 150, 255, 0.25);
    }

    input[type="text"], input[type="number"] {
      width: 100%;
      padding: 12px;
      margin: 8px 0;
      border: none;
      border-radius: 10px;
      outline: none;
      background: #2a2a2a;
      color: #fff;
      transition: background 0.2s ease, box-shadow 0.3s ease;
    }

    input:focus {
      background: #333;
      box-shadow: 0 0 6px #3e7cb1;
    }

    button {
      width: 100%;
      padding: 12px;
      margin-top: 10px;
      background: linear-gradient(135deg, #3e7cb1, #559fd2);
      color: white;
      border: none;
      border-radius: 10px;
      cursor: pointer;
      font-weight: bold;
      font-size: 15px;
      transition: transform 0.2s ease, box-shadow 0.3s ease;
    }

    button:hover {
      transform: translateY(-2px);
      box-shadow: 0 0 15px rgba(85, 159, 210, 0.5);
    }

    #links-container {
      margin: 10px 0;
      max-height: 200px;
      overflow-y: auto;
    }

    img {
      display: block;
      margin: 15px auto;
      border-radius: 10px;
      background: white;
      max-width: 100%;
    }

    h2 {
      text-align: center;
      margin-bottom: 10px;
      letter-spacing: 1px;
      color: #bcdfff;
      text-shadow: 0 0 10px rgba(85, 159, 210, 0.6);
    }

    footer {
      margin-top: 20px;
      text-align: center;
      font-size: 13px;
      color: #9cc9ff;
      text-shadow: 0 0 8px rgba(85, 159, 210, 0.4);
      letter-spacing: 0.3px;
      animation: glow 3s ease-in-out infinite alternate;
    }

    @keyframes glow {
      from { text-shadow: 0 0 8px rgba(85, 159, 210, 0.4); }
      to { text-shadow: 0 0 16px rgba(85, 159, 210, 0.8); }
    }
  </style>
</head>
<body>
  <div class="container">
    <h2>QR Code Generator</h2>

    <input type="number" id="quantity" min="1" max="100" value="1" placeholder="How many QR codes?" />
    <input type="text" id="size" value="400x400" placeholder="Image size (e.g. 400x400)" />

    <div id="links-container"></div>

    <button id="preview-btn">Generate Preview (First QR)</button>
    <img id="preview" src="" alt="QR Preview" style="display:none;" />
    <button id="export-btn" disabled>Export All QR Codes</button>
  </div>

  <footer>
    Developed by <strong>Siri Saksiri</strong> (PDS Computer Clubâ€™s President)
  </footer>

  <script>
    const quantityInput = document.getElementById('quantity');
    const sizeInput = document.getElementById('size');
    const linksContainer = document.getElementById('links-container');
    const previewBtn = document.getElementById('preview-btn');
    const exportBtn = document.getElementById('export-btn');
    const previewImg = document.getElementById('preview');

    function updateLinks() {
      linksContainer.innerHTML = '';
      const count = parseInt(quantityInput.value) || 1;
      for (let i = 0; i < count; i++) {
        const input = document.createElement('input');
        input.type = 'text';
        input.placeholder = `Link for QR #${i + 1}`;
        input.className = 'qr-link';
        linksContainer.appendChild(input);
      }
      exportBtn.disabled = count < 1;
    }

    quantityInput.addEventListener('input', updateLinks);
    updateLinks();

    previewBtn.addEventListener('click', () => {
      const size = sizeInput.value.trim();
      const firstLink = document.querySelector('.qr-link')?.value.trim();
      if (!firstLink) {
        alert("First QR code link is empty!");
        return;
      }
      if (!size.includes('x')) {
        alert("Size must be in format WIDTHxHEIGHT (e.g. 400x400).");
        return;
      }
      const url = `https://api.qrserver.com/v1/create-qr-code/?size=${size}&data=${encodeURIComponent(firstLink)}`;
      previewImg.src = url;
      previewImg.style.display = 'block';
    });

    exportBtn.addEventListener('click', async () => {
      const size = sizeInput.value.trim();
      const links = Array.from(document.querySelectorAll('.qr-link')).map(l => l.value.trim()).filter(Boolean);
      if (links.length === 0) {
        alert("Please fill in all QR data fields.");
        return;
      }

      const zip = new JSZip();
      for (let i = 0; i < links.length; i++) {
        const link = links[i];
        const url = `https://api.qrserver.com/v1/create-qr-code/?size=${size}&data=${encodeURIComponent(link)}`;
        const blob = await fetch(url).then(res => res.blob());
        zip.file(`qr_${i + 1}.png`, blob);
      }

      const blobZip = await zip.generateAsync({ type: 'blob' });
      const a = document.createElement('a');
      a.href = URL.createObjectURL(blobZip);
      a.download = 'QR_Codes.zip';
      a.click();
      URL.revokeObjectURL(a.href);
    });

    // Load JSZip dynamically
    const jszipScript = document.createElement('script');
    jszipScript.src = "https://cdnjs.cloudflare.com/ajax/libs/jszip/3.10.1/jszip.min.js";
    document.body.appendChild(jszipScript);
  </script>
</body>
</html>
